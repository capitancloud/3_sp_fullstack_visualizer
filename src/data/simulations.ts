import { Simulation, ArchitectureComponent } from '@/types/simulation';

export const architectureComponents: ArchitectureComponent[] = [
  // Main flow components
  {
    id: 'browser',
    type: 'browser',
    name: 'Browser',
    description: 'Il client che l\'utente usa per interagire con l\'applicazione',
    icon: 'Monitor',
    position: { x: 100, y: 200 },
  },
  {
    id: 'frontend',
    type: 'frontend',
    name: 'Frontend',
    description: 'L\'interfaccia utente (React, Vue, HTML/CSS/JS)',
    icon: 'Layout',
    position: { x: 300, y: 200 },
  },
  {
    id: 'backend',
    type: 'backend',
    name: 'Backend API',
    description: 'Il server che processa le richieste (Node.js, Python, Java)',
    icon: 'Server',
    position: { x: 500, y: 200 },
  },
  {
    id: 'database',
    type: 'database',
    name: 'Database',
    description: 'Dove vengono salvati i dati (PostgreSQL, MongoDB)',
    icon: 'Database',
    position: { x: 700, y: 200 },
  },
  // External services - top row
  {
    id: 'auth',
    type: 'external',
    name: 'Auth Service',
    description: 'Servizio di autenticazione esterno',
    icon: 'Shield',
    position: { x: 400, y: 50 },
  },
  {
    id: 'email',
    type: 'external',
    name: 'Email Service',
    description: 'Servizio per l\'invio di email',
    icon: 'Mail',
    position: { x: 550, y: 50 },
  },
  {
    id: 'payment',
    type: 'external',
    name: 'Payment Gateway',
    description: 'Gateway per pagamenti online (Stripe, PayPal)',
    icon: 'CreditCard',
    position: { x: 700, y: 50 },
  },
  // External services - bottom row
  {
    id: 'storage',
    type: 'external',
    name: 'File Storage',
    description: 'Servizio di archiviazione file (S3, Cloud Storage)',
    icon: 'HardDrive',
    position: { x: 100, y: 350 },
  },
  {
    id: 'cache',
    type: 'external',
    name: 'Cache (Redis)',
    description: 'Cache in memoria per performance (Redis, Memcached)',
    icon: 'Zap',
    position: { x: 300, y: 350 },
  },
  {
    id: 'websocket',
    type: 'external',
    name: 'WebSocket Server',
    description: 'Server per comunicazioni real-time bidirezionali',
    icon: 'Radio',
    position: { x: 500, y: 350 },
  },
];

export const simulations: Simulation[] = [
  // ============ BASE SIMULATIONS ============
  {
    id: 'login',
    name: 'Login Utente',
    description: 'Vedi come funziona l\'autenticazione di un utente',
    category: 'base',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: '{ email, password }',
        description: 'L\'utente inserisce email e password nel form di login',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'POST /api/login',
        description: 'Il frontend invia una richiesta HTTP POST al backend',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'database',
        data: 'SELECT * FROM users',
        description: 'Il backend cerca l\'utente nel database',
        type: 'request',
      },
      {
        id: 4,
        from: 'database',
        to: 'backend',
        data: '{ user: {...} }',
        description: 'Il database restituisce i dati dell\'utente',
        type: 'response',
      },
      {
        id: 5,
        from: 'backend',
        to: 'auth',
        data: 'generateToken(userId)',
        description: 'Il backend genera un token JWT per l\'autenticazione',
        type: 'request',
      },
      {
        id: 6,
        from: 'auth',
        to: 'backend',
        data: '{ token: "eyJhbG..." }',
        description: 'Il servizio auth restituisce il token',
        type: 'response',
      },
      {
        id: 7,
        from: 'backend',
        to: 'frontend',
        data: '200 OK { token, user }',
        description: 'Il backend risponde con successo e il token',
        type: 'response',
      },
      {
        id: 8,
        from: 'frontend',
        to: 'browser',
        data: 'localStorage.setItem()',
        description: 'Il frontend salva il token e mostra la dashboard',
        type: 'response',
      },
    ],
  },
  {
    id: 'register',
    name: 'Registrazione',
    description: 'Il flusso completo di registrazione di un nuovo utente',
    category: 'base',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: '{ nome, email, password }',
        description: 'L\'utente compila il form di registrazione',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'POST /api/register',
        description: 'Il frontend valida i dati e li invia al backend',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'database',
        data: 'INSERT INTO users',
        description: 'Il backend crea un nuovo record nel database',
        type: 'request',
      },
      {
        id: 4,
        from: 'database',
        to: 'backend',
        data: '{ id: 123, ... }',
        description: 'Il database conferma la creazione dell\'utente',
        type: 'response',
      },
      {
        id: 5,
        from: 'backend',
        to: 'email',
        data: 'sendWelcomeEmail()',
        description: 'Il backend invia un\'email di benvenuto',
        type: 'request',
      },
      {
        id: 6,
        from: 'email',
        to: 'backend',
        data: '{ sent: true }',
        description: 'Il servizio email conferma l\'invio',
        type: 'response',
      },
      {
        id: 7,
        from: 'backend',
        to: 'frontend',
        data: '201 Created',
        description: 'Il backend conferma la registrazione avvenuta',
        type: 'response',
      },
      {
        id: 8,
        from: 'frontend',
        to: 'browser',
        data: 'redirect("/login")',
        description: 'Il frontend reindirizza alla pagina di login',
        type: 'response',
      },
    ],
  },
  {
    id: 'load-data',
    name: 'Carica Dati',
    description: 'Come vengono caricati i dati da una pagina',
    category: 'base',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: 'navigate("/dashboard")',
        description: 'L\'utente naviga alla dashboard',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'GET /api/posts',
        description: 'Il frontend richiede i dati al backend con il token',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'auth',
        data: 'verifyToken()',
        description: 'Il backend verifica che il token sia valido',
        type: 'request',
      },
      {
        id: 4,
        from: 'auth',
        to: 'backend',
        data: '{ valid: true, userId: 123 }',
        description: 'Il servizio auth conferma l\'autenticazione',
        type: 'response',
      },
      {
        id: 5,
        from: 'backend',
        to: 'database',
        data: 'SELECT * FROM posts',
        description: 'Il backend richiede i post dal database',
        type: 'request',
      },
      {
        id: 6,
        from: 'database',
        to: 'backend',
        data: '[{ post1 }, { post2 }...]',
        description: 'Il database restituisce la lista dei post',
        type: 'response',
      },
      {
        id: 7,
        from: 'backend',
        to: 'frontend',
        data: '200 OK { posts: [...] }',
        description: 'Il backend risponde con i dati formattati',
        type: 'response',
      },
      {
        id: 8,
        from: 'frontend',
        to: 'browser',
        data: 'render(posts)',
        description: 'Il frontend mostra i post nella UI',
        type: 'response',
      },
    ],
  },

  // ============ CRUD BASE ============
  {
    id: 'crud-create',
    name: 'Create (Creazione)',
    description: 'Come creare un nuovo record nel database',
    category: 'crud',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: '{ title, content }',
        description: 'L\'utente compila il form per creare un nuovo post',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'POST /api/posts',
        description: 'Il frontend invia i dati al backend con metodo POST',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'database',
        data: 'INSERT INTO posts (title, content) VALUES (...)',
        description: 'Il backend inserisce il nuovo record nel database',
        type: 'request',
      },
      {
        id: 4,
        from: 'database',
        to: 'backend',
        data: '{ id: 1, title, content, created_at }',
        description: 'Il database restituisce il record creato con l\'ID',
        type: 'response',
      },
      {
        id: 5,
        from: 'backend',
        to: 'frontend',
        data: '201 Created { post: {...} }',
        description: 'Il backend risponde con status 201 e il post creato',
        type: 'response',
      },
      {
        id: 6,
        from: 'frontend',
        to: 'browser',
        data: 'showToast("Post creato!")',
        description: 'Il frontend mostra conferma e aggiorna la lista',
        type: 'response',
      },
    ],
  },
  {
    id: 'crud-read',
    name: 'Read (Lettura)',
    description: 'Come recuperare dati dal database',
    category: 'crud',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: 'click("Vedi dettaglio")',
        description: 'L\'utente clicca per vedere i dettagli del post',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'GET /api/posts/1',
        description: 'Il frontend richiede i dati con metodo GET',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'database',
        data: 'SELECT * FROM posts WHERE id = 1',
        description: 'Il backend cerca il record nel database',
        type: 'request',
      },
      {
        id: 4,
        from: 'database',
        to: 'backend',
        data: '{ id: 1, title, content, ... }',
        description: 'Il database restituisce il record trovato',
        type: 'response',
      },
      {
        id: 5,
        from: 'backend',
        to: 'frontend',
        data: '200 OK { post: {...} }',
        description: 'Il backend risponde con status 200 e i dati',
        type: 'response',
      },
      {
        id: 6,
        from: 'frontend',
        to: 'browser',
        data: 'render(post)',
        description: 'Il frontend mostra i dettagli del post',
        type: 'response',
      },
    ],
  },
  {
    id: 'crud-update',
    name: 'Update (Modifica)',
    description: 'Come aggiornare un record esistente',
    category: 'crud',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: '{ title: "Nuovo titolo" }',
        description: 'L\'utente modifica il titolo del post',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'PUT /api/posts/1',
        description: 'Il frontend invia l\'aggiornamento con metodo PUT',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'database',
        data: 'UPDATE posts SET title = "Nuovo titolo" WHERE id = 1',
        description: 'Il backend aggiorna il record esistente',
        type: 'request',
      },
      {
        id: 4,
        from: 'database',
        to: 'backend',
        data: '{ updated: 1 }',
        description: 'Il database conferma l\'aggiornamento',
        type: 'response',
      },
      {
        id: 5,
        from: 'backend',
        to: 'frontend',
        data: '200 OK { post: {...} }',
        description: 'Il backend risponde con il post aggiornato',
        type: 'response',
      },
      {
        id: 6,
        from: 'frontend',
        to: 'browser',
        data: 'showToast("Modifiche salvate!")',
        description: 'Il frontend mostra conferma all\'utente',
        type: 'response',
      },
    ],
  },
  {
    id: 'crud-delete',
    name: 'Delete (Eliminazione)',
    description: 'Come eliminare un record dal database',
    category: 'crud',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: 'confirmDelete()',
        description: 'L\'utente conferma l\'eliminazione del post',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'DELETE /api/posts/1',
        description: 'Il frontend richiede l\'eliminazione con metodo DELETE',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'database',
        data: 'DELETE FROM posts WHERE id = 1',
        description: 'Il backend elimina il record dal database',
        type: 'request',
      },
      {
        id: 4,
        from: 'database',
        to: 'backend',
        data: '{ deleted: 1 }',
        description: 'Il database conferma l\'eliminazione',
        type: 'response',
      },
      {
        id: 5,
        from: 'backend',
        to: 'frontend',
        data: '204 No Content',
        description: 'Il backend risponde con status 204 (successo senza body)',
        type: 'response',
      },
      {
        id: 6,
        from: 'frontend',
        to: 'browser',
        data: 'redirect("/posts")',
        description: 'Il frontend reindirizza alla lista aggiornata',
        type: 'response',
      },
    ],
  },

  // ============ CRUD ADVANCED ============
  {
    id: 'update-profile',
    name: 'Modifica Profilo',
    description: 'Aggiornamento dei dati del profilo utente',
    category: 'crud',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: '{ nome, bio, avatar }',
        description: 'L\'utente modifica i campi del profilo',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'PUT /api/profile',
        description: 'Il frontend invia i nuovi dati al backend',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'auth',
        data: 'verifyToken()',
        description: 'Il backend verifica l\'identità dell\'utente',
        type: 'request',
      },
      {
        id: 4,
        from: 'auth',
        to: 'backend',
        data: '{ valid: true, userId: 123 }',
        description: 'Token verificato con successo',
        type: 'response',
      },
      {
        id: 5,
        from: 'backend',
        to: 'database',
        data: 'UPDATE users SET...',
        description: 'Il backend aggiorna il record nel database',
        type: 'request',
      },
      {
        id: 6,
        from: 'database',
        to: 'backend',
        data: '{ updated: true }',
        description: 'Il database conferma l\'aggiornamento',
        type: 'response',
      },
      {
        id: 7,
        from: 'backend',
        to: 'frontend',
        data: '200 OK { user: {...} }',
        description: 'Il backend restituisce il profilo aggiornato',
        type: 'response',
      },
      {
        id: 8,
        from: 'frontend',
        to: 'browser',
        data: 'showToast("Salvato!")',
        description: 'Il frontend mostra conferma all\'utente',
        type: 'response',
      },
    ],
  },
  {
    id: 'delete-account',
    name: 'Elimina Account',
    description: 'Procedura completa di eliminazione account',
    category: 'crud',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: 'confirmDelete()',
        description: 'L\'utente conferma l\'eliminazione account',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'DELETE /api/account',
        description: 'Il frontend richiede la cancellazione',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'auth',
        data: 'verifyIdentity(password)',
        description: 'Il backend verifica l\'identità con password',
        type: 'request',
      },
      {
        id: 4,
        from: 'auth',
        to: 'backend',
        data: '{ verified: true }',
        description: 'Identità confermata',
        type: 'response',
      },
      {
        id: 5,
        from: 'backend',
        to: 'database',
        data: 'DELETE FROM users',
        description: 'Il backend elimina l\'utente dal database',
        type: 'request',
      },
      {
        id: 6,
        from: 'database',
        to: 'backend',
        data: '{ deleted: true }',
        description: 'Il database conferma l\'eliminazione',
        type: 'response',
      },
      {
        id: 7,
        from: 'backend',
        to: 'email',
        data: 'sendGoodbyeEmail()',
        description: 'Il backend invia email di conferma eliminazione',
        type: 'request',
      },
      {
        id: 8,
        from: 'email',
        to: 'backend',
        data: '{ sent: true }',
        description: 'Email inviata con successo',
        type: 'response',
      },
      {
        id: 9,
        from: 'backend',
        to: 'frontend',
        data: '200 OK',
        description: 'Il backend conferma l\'operazione',
        type: 'response',
      },
      {
        id: 10,
        from: 'frontend',
        to: 'browser',
        data: 'redirect("/goodbye")',
        description: 'Il frontend esegue logout e redirect',
        type: 'response',
      },
    ],
  },
  {
    id: 'search-filter',
    name: 'Ricerca con Filtri',
    description: 'Ricerca avanzata con cache per performance',
    category: 'crud',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: '{ query: "react", category: "tech" }',
        description: 'L\'utente inserisce criteri di ricerca',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'GET /api/search?q=react&cat=tech',
        description: 'Il frontend invia la query al backend',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'cache',
        data: 'GET search:react:tech',
        description: 'Il backend controlla se i risultati sono in cache',
        type: 'request',
      },
      {
        id: 4,
        from: 'cache',
        to: 'backend',
        data: '{ hit: false }',
        description: 'Cache miss - dati non presenti',
        type: 'response',
      },
      {
        id: 5,
        from: 'backend',
        to: 'database',
        data: 'SELECT * FROM posts WHERE...',
        description: 'Il backend esegue la query sul database',
        type: 'request',
      },
      {
        id: 6,
        from: 'database',
        to: 'backend',
        data: '[{ result1 }, { result2 }...]',
        description: 'Il database restituisce i risultati',
        type: 'response',
      },
      {
        id: 7,
        from: 'backend',
        to: 'cache',
        data: 'SET search:react:tech TTL=300',
        description: 'Il backend salva i risultati in cache (5 min)',
        type: 'request',
      },
      {
        id: 8,
        from: 'cache',
        to: 'backend',
        data: '{ saved: true }',
        description: 'Cache aggiornata con successo',
        type: 'response',
      },
      {
        id: 9,
        from: 'backend',
        to: 'frontend',
        data: '200 OK { results: [...] }',
        description: 'Il backend risponde con i risultati',
        type: 'response',
      },
      {
        id: 10,
        from: 'frontend',
        to: 'browser',
        data: 'renderResults()',
        description: 'Il frontend mostra i risultati filtrati',
        type: 'response',
      },
    ],
  },

  // ============ ERROR HANDLING ============
  {
    id: 'error-401',
    name: 'Errore 401 Unauthorized',
    description: 'Gestione di un token scaduto o invalido',
    category: 'errors',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: 'navigate("/dashboard")',
        description: 'L\'utente prova ad accedere a una pagina protetta',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'GET /api/data (token scaduto)',
        description: 'Il frontend invia richiesta con token scaduto',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'auth',
        data: 'verifyToken(expired)',
        description: 'Il backend tenta di verificare il token',
        type: 'request',
      },
      {
        id: 4,
        from: 'auth',
        to: 'backend',
        data: '{ valid: false, expired: true }',
        description: 'Il servizio auth rileva token scaduto',
        type: 'error',
      },
      {
        id: 5,
        from: 'backend',
        to: 'frontend',
        data: '401 Unauthorized',
        description: 'Il backend rifiuta la richiesta',
        type: 'error',
      },
      {
        id: 6,
        from: 'frontend',
        to: 'browser',
        data: 'redirect("/login")',
        description: 'Il frontend pulisce la sessione e reindirizza',
        type: 'response',
      },
    ],
  },
  {
    id: 'error-404',
    name: 'Errore 404 Not Found',
    description: 'Richiesta di una risorsa inesistente',
    category: 'errors',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: 'navigate("/post/99999")',
        description: 'L\'utente cerca un post inesistente',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'GET /api/posts/99999',
        description: 'Il frontend richiede il post specifico',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'database',
        data: 'SELECT * FROM posts WHERE id=99999',
        description: 'Il backend cerca il post nel database',
        type: 'request',
      },
      {
        id: 4,
        from: 'database',
        to: 'backend',
        data: '{ rows: [] }',
        description: 'Il database non trova nessun risultato',
        type: 'response',
      },
      {
        id: 5,
        from: 'backend',
        to: 'frontend',
        data: '404 Not Found',
        description: 'Il backend risponde con errore 404',
        type: 'error',
      },
      {
        id: 6,
        from: 'frontend',
        to: 'browser',
        data: 'render(<NotFound />)',
        description: 'Il frontend mostra la pagina di errore',
        type: 'response',
      },
    ],
  },
  {
    id: 'error-500',
    name: 'Errore 500 Server Error',
    description: 'Errore interno del server',
    category: 'errors',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: 'submitForm(data)',
        description: 'L\'utente invia un form',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'POST /api/process',
        description: 'Il frontend invia i dati al backend',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'database',
        data: 'COMPLEX QUERY...',
        description: 'Il backend esegue un\'operazione complessa',
        type: 'request',
      },
      {
        id: 4,
        from: 'database',
        to: 'backend',
        data: 'ERROR: Connection lost',
        description: 'Il database perde la connessione',
        type: 'error',
      },
      {
        id: 5,
        from: 'backend',
        to: 'frontend',
        data: '500 Internal Server Error',
        description: 'Il backend risponde con errore generico',
        type: 'error',
      },
      {
        id: 6,
        from: 'frontend',
        to: 'browser',
        data: 'showError("Riprova più tardi")',
        description: 'Il frontend mostra messaggio user-friendly',
        type: 'response',
      },
    ],
  },
  {
    id: 'error-timeout',
    name: 'Timeout Database',
    description: 'Query troppo lenta che causa timeout',
    category: 'errors',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: 'loadHeavyReport()',
        description: 'L\'utente richiede un report pesante',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'GET /api/reports/yearly',
        description: 'Il frontend richiede dati annuali',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'database',
        data: 'SELECT * FROM logs (milioni di righe)',
        description: 'Il backend esegue query molto pesante',
        type: 'request',
      },
      {
        id: 4,
        from: 'database',
        to: 'backend',
        data: 'TIMEOUT after 30s',
        description: 'Il database non risponde in tempo',
        type: 'error',
      },
      {
        id: 5,
        from: 'backend',
        to: 'frontend',
        data: '504 Gateway Timeout',
        description: 'Il backend segnala il timeout',
        type: 'error',
      },
      {
        id: 6,
        from: 'frontend',
        to: 'browser',
        data: 'showRetryOption()',
        description: 'Il frontend offre opzione di retry',
        type: 'response',
      },
    ],
  },

  // ============ PAYMENTS ============
  {
    id: 'payment-flow',
    name: 'Pagamento con Carta',
    description: 'Flusso completo di pagamento e-commerce',
    category: 'payments',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: '{ card: "4242...", amount: 99.99 }',
        description: 'L\'utente inserisce i dati della carta',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'POST /api/checkout',
        description: 'Il frontend invia richiesta di pagamento',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'auth',
        data: 'verifyUser()',
        description: 'Il backend verifica l\'utente',
        type: 'request',
      },
      {
        id: 4,
        from: 'auth',
        to: 'backend',
        data: '{ userId: 123, verified: true }',
        description: 'Utente verificato',
        type: 'response',
      },
      {
        id: 5,
        from: 'backend',
        to: 'payment',
        data: 'createPaymentIntent(99.99)',
        description: 'Il backend crea intent di pagamento su Stripe',
        type: 'request',
      },
      {
        id: 6,
        from: 'payment',
        to: 'backend',
        data: '{ clientSecret: "pi_xxx" }',
        description: 'Stripe restituisce il client secret',
        type: 'response',
      },
      {
        id: 7,
        from: 'backend',
        to: 'database',
        data: 'INSERT INTO orders (pending)',
        description: 'Il backend crea ordine in stato pending',
        type: 'request',
      },
      {
        id: 8,
        from: 'database',
        to: 'backend',
        data: '{ orderId: 456 }',
        description: 'Ordine creato nel database',
        type: 'response',
      },
      {
        id: 9,
        from: 'backend',
        to: 'frontend',
        data: '{ clientSecret, orderId }',
        description: 'Il backend invia i dati al frontend',
        type: 'response',
      },
      {
        id: 10,
        from: 'frontend',
        to: 'payment',
        data: 'confirmCardPayment()',
        description: 'Il frontend conferma il pagamento con Stripe',
        type: 'request',
      },
      {
        id: 11,
        from: 'payment',
        to: 'frontend',
        data: '{ status: "succeeded" }',
        description: 'Stripe conferma pagamento riuscito',
        type: 'response',
      },
      {
        id: 12,
        from: 'frontend',
        to: 'backend',
        data: 'POST /api/confirm-order',
        description: 'Il frontend notifica il backend del successo',
        type: 'request',
      },
      {
        id: 13,
        from: 'backend',
        to: 'database',
        data: 'UPDATE orders SET status="paid"',
        description: 'Il backend aggiorna lo stato dell\'ordine',
        type: 'request',
      },
      {
        id: 14,
        from: 'database',
        to: 'backend',
        data: '{ updated: true }',
        description: 'Ordine aggiornato a "pagato"',
        type: 'response',
      },
      {
        id: 15,
        from: 'backend',
        to: 'email',
        data: 'sendReceipt(orderId)',
        description: 'Il backend invia ricevuta via email',
        type: 'request',
      },
      {
        id: 16,
        from: 'email',
        to: 'backend',
        data: '{ sent: true }',
        description: 'Ricevuta inviata con successo',
        type: 'response',
      },
      {
        id: 17,
        from: 'backend',
        to: 'frontend',
        data: '200 OK { success: true }',
        description: 'Il backend conferma completamento',
        type: 'response',
      },
      {
        id: 18,
        from: 'frontend',
        to: 'browser',
        data: 'redirect("/order-success")',
        description: 'Il frontend mostra pagina di successo',
        type: 'response',
      },
    ],
  },

  // ============ FILE UPLOAD ============
  {
    id: 'file-upload',
    name: 'Upload Immagine',
    description: 'Caricamento file su storage cloud',
    category: 'files',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: 'File: image.jpg (2.5MB)',
        description: 'L\'utente seleziona un file da caricare',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'POST /api/upload (multipart)',
        description: 'Il frontend invia il file al backend',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'auth',
        data: 'checkUploadPermission()',
        description: 'Il backend verifica i permessi di upload',
        type: 'request',
      },
      {
        id: 4,
        from: 'auth',
        to: 'backend',
        data: '{ canUpload: true, maxSize: "10MB" }',
        description: 'Utente autorizzato all\'upload',
        type: 'response',
      },
      {
        id: 5,
        from: 'backend',
        to: 'storage',
        data: 'uploadFile(image.jpg)',
        description: 'Il backend carica il file su cloud storage',
        type: 'request',
      },
      {
        id: 6,
        from: 'storage',
        to: 'backend',
        data: '{ url: "https://cdn/abc.jpg", fileId }',
        description: 'Storage restituisce URL pubblico del file',
        type: 'response',
      },
      {
        id: 7,
        from: 'backend',
        to: 'database',
        data: 'INSERT INTO files (url, userId)',
        description: 'Il backend salva i metadati nel database',
        type: 'request',
      },
      {
        id: 8,
        from: 'database',
        to: 'backend',
        data: '{ fileId: 789 }',
        description: 'Metadati salvati con successo',
        type: 'response',
      },
      {
        id: 9,
        from: 'backend',
        to: 'frontend',
        data: '201 Created { fileUrl }',
        description: 'Il backend conferma l\'upload riuscito',
        type: 'response',
      },
      {
        id: 10,
        from: 'frontend',
        to: 'browser',
        data: 'showPreview(fileUrl)',
        description: 'Il frontend mostra anteprima dell\'immagine',
        type: 'response',
      },
    ],
  },

  // ============ PASSWORD RESET ============
  {
    id: 'reset-password',
    name: 'Reset Password',
    description: 'Recupero password via email',
    category: 'auth',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: '{ email: "user@example.com" }',
        description: 'L\'utente inserisce la propria email',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'POST /api/forgot-password',
        description: 'Il frontend invia richiesta di reset',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'database',
        data: 'SELECT * FROM users WHERE email=...',
        description: 'Il backend cerca l\'utente nel database',
        type: 'request',
      },
      {
        id: 4,
        from: 'database',
        to: 'backend',
        data: '{ userId: 123, email: "..." }',
        description: 'Utente trovato nel database',
        type: 'response',
      },
      {
        id: 5,
        from: 'backend',
        to: 'auth',
        data: 'generateResetToken(userId)',
        description: 'Il backend genera un token temporaneo',
        type: 'request',
      },
      {
        id: 6,
        from: 'auth',
        to: 'backend',
        data: '{ resetToken: "abc123", expires: "1h" }',
        description: 'Token generato con scadenza 1 ora',
        type: 'response',
      },
      {
        id: 7,
        from: 'backend',
        to: 'database',
        data: 'INSERT INTO reset_tokens',
        description: 'Il backend salva il token nel database',
        type: 'request',
      },
      {
        id: 8,
        from: 'database',
        to: 'backend',
        data: '{ saved: true }',
        description: 'Token salvato con successo',
        type: 'response',
      },
      {
        id: 9,
        from: 'backend',
        to: 'email',
        data: 'sendResetEmail(token)',
        description: 'Il backend invia email con link di reset',
        type: 'request',
      },
      {
        id: 10,
        from: 'email',
        to: 'backend',
        data: '{ sent: true }',
        description: 'Email inviata all\'utente',
        type: 'response',
      },
      {
        id: 11,
        from: 'backend',
        to: 'frontend',
        data: '200 OK "Email inviata"',
        description: 'Il backend conferma l\'invio',
        type: 'response',
      },
      {
        id: 12,
        from: 'frontend',
        to: 'browser',
        data: 'showMessage("Controlla email")',
        description: 'Il frontend mostra conferma all\'utente',
        type: 'response',
      },
    ],
  },

  // ============ CACHE ============
  {
    id: 'cache-flow',
    name: 'Cache Hit/Miss',
    description: 'Come funziona la cache per migliorare le performance',
    category: 'performance',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: 'loadTrending()',
        description: 'L\'utente richiede contenuti popolari',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'backend',
        data: 'GET /api/trending',
        description: 'Il frontend richiede i dati trending',
        type: 'request',
      },
      {
        id: 3,
        from: 'backend',
        to: 'cache',
        data: 'GET trending_data',
        description: 'Il backend cerca prima nella cache Redis',
        type: 'request',
      },
      {
        id: 4,
        from: 'cache',
        to: 'backend',
        data: '{ hit: true, data: [...] }',
        description: 'CACHE HIT! Dati trovati (risposta veloce)',
        type: 'response',
      },
      {
        id: 5,
        from: 'backend',
        to: 'frontend',
        data: '200 OK { data: [...] } (5ms)',
        description: 'Il backend risponde istantaneamente',
        type: 'response',
      },
      {
        id: 6,
        from: 'frontend',
        to: 'browser',
        data: 'renderTrending() ⚡',
        description: 'Il frontend mostra i dati in tempo record',
        type: 'response',
      },
    ],
  },

  // ============ REAL-TIME ============
  {
    id: 'realtime-notification',
    name: 'Notifica Real-Time',
    description: 'Ricezione di notifiche push via WebSocket',
    category: 'realtime',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: 'initWebSocket()',
        description: 'L\'app si connette al server WebSocket',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'websocket',
        data: 'subscribe("notifications")',
        description: 'Il frontend si iscrive al canale notifiche',
        type: 'request',
      },
      {
        id: 3,
        from: 'websocket',
        to: 'frontend',
        data: '{ connected: true, channel: "notifications" }',
        description: 'Connessione WebSocket stabilita',
        type: 'response',
      },
      {
        id: 4,
        from: 'backend',
        to: 'database',
        data: 'INSERT INTO events (new_follower)',
        description: '...qualcuno segue l\'utente (evento esterno)',
        type: 'request',
      },
      {
        id: 5,
        from: 'database',
        to: 'backend',
        data: 'TRIGGER: new_event',
        description: 'Il database notifica il backend del nuovo evento',
        type: 'response',
      },
      {
        id: 6,
        from: 'backend',
        to: 'websocket',
        data: 'broadcast(userId, notification)',
        description: 'Il backend invia la notifica via WebSocket',
        type: 'request',
      },
      {
        id: 7,
        from: 'websocket',
        to: 'frontend',
        data: '{ type: "new_follower", user: "Mario" }',
        description: 'WebSocket recapita la notifica al client',
        type: 'response',
      },
      {
        id: 8,
        from: 'frontend',
        to: 'browser',
        data: 'showToast("Mario ti segue!")',
        description: 'Il frontend mostra la notifica toast',
        type: 'response',
      },
    ],
  },
  {
    id: 'realtime-chat',
    name: 'Chat Real-Time',
    description: 'Messaggistica istantanea bidirezionale',
    category: 'realtime',
    steps: [
      {
        id: 1,
        from: 'browser',
        to: 'frontend',
        data: '{ text: "Ciao!" }',
        description: 'L\'utente scrive un messaggio in chat',
        type: 'request',
      },
      {
        id: 2,
        from: 'frontend',
        to: 'websocket',
        data: '{ type: "message", room: "123", text: "Ciao!" }',
        description: 'Il frontend invia via WebSocket',
        type: 'request',
      },
      {
        id: 3,
        from: 'websocket',
        to: 'backend',
        data: '{ newMessage: {...} }',
        description: 'WebSocket inoltra al backend per persistenza',
        type: 'request',
      },
      {
        id: 4,
        from: 'backend',
        to: 'database',
        data: 'INSERT INTO messages',
        description: 'Il backend salva il messaggio nel database',
        type: 'request',
      },
      {
        id: 5,
        from: 'database',
        to: 'backend',
        data: '{ messageId: 999, timestamp }',
        description: 'Messaggio salvato con timestamp',
        type: 'response',
      },
      {
        id: 6,
        from: 'backend',
        to: 'websocket',
        data: 'broadcastToRoom("123", message)',
        description: 'Il backend invia a tutti nella stanza',
        type: 'request',
      },
      {
        id: 7,
        from: 'websocket',
        to: 'frontend',
        data: '{ from: "Tu", text: "Ciao!", time: "12:30" }',
        description: 'Tutti i client nella stanza ricevono il messaggio',
        type: 'response',
      },
      {
        id: 8,
        from: 'frontend',
        to: 'browser',
        data: 'appendMessage()',
        description: 'Il frontend aggiorna la chat in tempo reale',
        type: 'response',
      },
    ],
  },
];
